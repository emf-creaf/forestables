<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Selecting plots • forestables</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selecting plots">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">forestables</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/documentacion.html">Inventory data ingestion process</a></li>
    <li><a class="dropdown-item" href="../articles/inventory_data_tibble.html">Inventory data output</a></li>
    <li><a class="dropdown-item" href="../articles/selecting_plots.html">Selecting plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selecting plots</h1>
            
      

      <div class="d-none name"><code>selecting_plots.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://emf-creaf.github.io/forestables/">forestables</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: data.table</span></span>
<span><span class="co">#&gt; Loading required package: dtplyr</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:data.table':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     between, first, last</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette explains how to retrieve information about available
inventory plots and using it to select them based to use in modelling or
analyses.</p>
<p>Workflows with all three inventories (FFI, FIA and IFN) are shown
below</p>
</div>
<div class="section level2">
<h2 id="ffi-workflow">FFI workflow<a class="anchor" aria-label="anchor" href="#ffi-workflow"></a>
</h2>
<p>In this example for the French forest inventory (FFI) we will explore
the plots in the Eastern Pyrenees and Aude departments (codes “66” and
“11”) in the year 2012.<br>
First step is to download the inventory if we haven’t done it yet. As
this is a vignette, we will download the data to a temporary folder that
is removed after the R session ends. But is heavily recommended to
download the data to a permanent folder in your project/analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download the FFI data if not already (In this example the data is downloaded</span></span>
<span><span class="co"># in a temporal folder and is removed after the R session ends)</span></span>
<span><span class="va">ffi_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/download_inventory.html">download_inventory</a></span><span class="op">(</span><span class="st">"FFI"</span>, <span class="va">ffi_folder</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Downloading FFI available data</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Unzipping downloaded data in <span style="color: #0000BB;">/tmp/RtmpXWXHqO</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Done!</span></span></code></pre></div>
<p>If we don’t want to perform any selection of plots and we need all
plots for 2012, then we can just retrieve all data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ffi_2012_all_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ffi_to_tibble.html">ffi_to_tibble</a></span><span class="op">(</span></span>
<span>  departments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"66"</span>, <span class="st">"11"</span><span class="op">)</span>,</span>
<span>  years <span class="op">=</span> <span class="fl">2012</span>,</span>
<span>  folder <span class="op">=</span> <span class="va">ffi_folder</span>,</span>
<span>  clean_empty <span class="op">=</span> <span class="st">"tree"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>But in some cases we need to perform some plots selection, to reduce
the number of plots or simply to focus in the interesting plots for our
goal.<br>
For this, we can use the department codes to obtain some basic metadata
(plot codes, coordinates and campaign year) with
<code><a href="../reference/show_plots_from.html">show_plots_from()</a></code>.<br>
We need the inventory we want plots from, the folder containing the
downloaded inventory files and a vector with the department codes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the plots for those departments</span></span>
<span><span class="va">ffi_selected_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/show_plots_from.html">show_plots_from</a></span><span class="op">(</span></span>
<span>  inventory <span class="op">=</span> <span class="st">"FFI"</span>,</span>
<span>  folder <span class="op">=</span> <span class="va">ffi_folder</span>,</span>
<span>  departments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"66"</span>, <span class="st">"11"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ffi_selected_plots</span></span>
<span><span class="co">#&gt; Simple feature collection with 3830 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 1.711533 ymin: 42.34551 xmax: 3.186679 ymax: 43.45049</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,830 × 4</span></span></span>
<span><span class="co">#&gt;    CAMPAGNE   IDP DEP              geometry</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     <span style="text-decoration: underline;">2</span>005   132 11    (2.008273 43.05466)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     <span style="text-decoration: underline;">2</span>005   257 66    (2.545421 42.53404)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     <span style="text-decoration: underline;">2</span>005   405 11     (2.424819 43.0731)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     <span style="text-decoration: underline;">2</span>005   909 11    (2.204115 43.12696)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     <span style="text-decoration: underline;">2</span>005  <span style="text-decoration: underline;">1</span>061 66    (2.375614 42.78569)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     <span style="text-decoration: underline;">2</span>005  <span style="text-decoration: underline;">1</span>203 11     (2.326722 43.3966)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     <span style="text-decoration: underline;">2</span>005  <span style="text-decoration: underline;">1</span>236 11    (1.908529 43.28791)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     <span style="text-decoration: underline;">2</span>005  <span style="text-decoration: underline;">1</span>949 66    (2.156803 42.57001)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     <span style="text-decoration: underline;">2</span>005  <span style="text-decoration: underline;">2</span>905 11     (2.62124 43.14463)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     <span style="text-decoration: underline;">2</span>005  <span style="text-decoration: underline;">2</span>922 11    (3.186679 43.21353)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3,820 more rows</span></span></span></code></pre></div>
<p>These are all the plots present in those departments for all years,
but we want 2012 plots, so we filter the results by campaign year:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ffi_selected_plots</span> <span class="op">&lt;-</span> <span class="va">ffi_selected_plots</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">CAMPAGNE</span> <span class="op">==</span> <span class="fl">2012</span><span class="op">)</span></span>
<span><span class="va">ffi_selected_plots</span></span>
<span><span class="co">#&gt; Simple feature collection with 275 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 1.711729 ymin: 42.3546 xmax: 3.186413 ymax: 43.43249</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 275 × 4</span></span></span>
<span><span class="co">#&gt;    CAMPAGNE    IDP DEP              geometry</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">200</span>809 11    (2.595977 42.98299)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">201</span>113 11     (2.547623 43.1448)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">201</span>148 66    (2.253964 42.58809)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">201</span>585 11    (2.670319 43.14449)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">201</span>971 11    (2.523783 43.36049)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">202</span>180 11     (2.40033 43.09108)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">202</span>822 11     (2.351273 42.9833)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">203</span>283 11    (2.302064 43.41457)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">204</span>589 11     (2.057275 43.0548)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     <span style="text-decoration: underline;">2</span>012 <span style="text-decoration: underline;">209</span>775 11    (2.522623 43.00111)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 265 more rows</span></span></span></code></pre></div>
<p>We can visualize the geographic distribution of plots selected:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ffi_selected_plots</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">DEP</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">2</span>, palette <span class="op">=</span> <span class="st">"Zissou 1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="selecting_plots_files/figure-html/ffi_plots_loc-1.png" width="576" style="display: block; margin: auto;"></p>
<p>For further selection we can filter by plot identifier (IDP) if we
know them or use an spatial polygon to filter by coordinates. Let’s say
we are interested in these departments, but only in the mediterranean
part. We can then select those plots and create a <em>filter list</em>
to use it to retrieve those plots data from the inventory files:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the area we want the plots in:</span></span>
<span><span class="va">mediterranean_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">2.6</span>, xmax <span class="op">=</span> <span class="fl">3.2</span>, ymax <span class="op">=</span> <span class="fl">42</span>, ymin <span class="op">=</span> <span class="fl">44</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the filter list</span></span>
<span><span class="va">ffi_filter_list</span> <span class="op">&lt;-</span> <span class="va">ffi_selected_plots</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">st_filter</a></span><span class="op">(</span><span class="va">mediterranean_area</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/create_filter_list.html">create_filter_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## we can do all in one pipe:</span></span>
<span><span class="co"># ffi_filter_list &lt;-</span></span>
<span><span class="co">#   show_plots_from("FFI", folder = ffi_folder, departments = c("66", "11")) |&gt;</span></span>
<span><span class="co">#   filter(CAMPAGNE == 2012) |&gt;</span></span>
<span><span class="co">#   st_filter(mediterranean_area) |&gt;</span></span>
<span><span class="co">#   create_filter_list()</span></span></code></pre></div>
<p>And now we can just modify the <code>ffi_to_tibble</code> call we did
above to add the filter list:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We can parallelize the process with the future package.</span></span>
<span><span class="co">## In this case we use 4 parallel processes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="st">"multisession"</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the data for the selected plots</span></span>
<span><span class="va">ffi_data_2012</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ffi_to_tibble.html">ffi_to_tibble</a></span><span class="op">(</span></span>
<span>  departments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"66"</span>, <span class="st">"11"</span><span class="op">)</span>,</span>
<span>  years <span class="op">=</span> <span class="fl">2012</span>,</span>
<span>  filter_list <span class="op">=</span> <span class="va">ffi_filter_list</span>,</span>
<span>  folder <span class="op">=</span> <span class="va">ffi_folder</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Start</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing 1 year</span></span>
<span><span class="co">#&gt; Getting ready to retrieve <span style="font-weight: bold;">67</span> plots for <span style="color: #0000BB;">2012</span></span></span>
<span></span>
<span><span class="va">ffi_data_2012</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 67 × 16</span></span></span>
<span><span class="co">#&gt;    id_unique_code  year plot  coordx coordy coord_sys   crs aspect slope country</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> FR_11_201585    <span style="text-decoration: underline;">2</span>012 2015… 6.73<span style="color: #949494;">e</span>5 6.23<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154   <span style="color: #BB0000;">NA</span>       0 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> FR_11_212649    <span style="text-decoration: underline;">2</span>012 2126… 6.75<span style="color: #949494;">e</span>5 6.21<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154  333      94 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> FR_11_221571    <span style="text-decoration: underline;">2</span>012 2215… 6.73<span style="color: #949494;">e</span>5 6.21<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154   97.2    23 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> FR_11_223894    <span style="text-decoration: underline;">2</span>012 2238… 6.89<span style="color: #949494;">e</span>5 6.22<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154  279      36 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> FR_11_227770    <span style="text-decoration: underline;">2</span>012 2277… 7.15<span style="color: #949494;">e</span>5 6.23<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154    9      20 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> FR_11_239436    <span style="text-decoration: underline;">2</span>012 2394… 6.77<span style="color: #949494;">e</span>5 6.22<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154  246.     25 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> FR_11_245118    <span style="text-decoration: underline;">2</span>012 2451… 6.79<span style="color: #949494;">e</span>5 6.23<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154  198      15 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> FR_11_245683    <span style="text-decoration: underline;">2</span>012 2456… 6.71<span style="color: #949494;">e</span>5 6.22<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154  299.     28 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> FR_11_253438    <span style="text-decoration: underline;">2</span>012 2534… 6.91<span style="color: #949494;">e</span>5 6.20<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154   72      45 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FR_11_257965    <span style="text-decoration: underline;">2</span>012 2579… 6.91<span style="color: #949494;">e</span>5 6.22<span style="color: #949494;">e</span>6 LAMBERT    <span style="text-decoration: underline;">2</span>154   40.5    30 FR     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 57 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more variables: dep &lt;chr&gt;, dep_name &lt;chr&gt;, visite &lt;int&gt;, tree &lt;list&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   understory &lt;list&gt;, regen &lt;list&gt;</span></span></span></code></pre></div>
<p>Now we can explore the data, for example the most abundant species
and their mean diameter for each plot they are in:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ffi_data_2012</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># clean plots without tree data</span></span>
<span>  <span class="fu"><a href="../reference/clean_empty.html">clean_empty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tree"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># convert inventory table to sf/spatial object</span></span>
<span>  <span class="fu"><a href="../reference/inventory_as_sf.html">inventory_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># unnest the tree data</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="st">"tree"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># calculate dbh by species in each plot</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id_unique_code</span>, <span class="va">sp_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>dbh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dbh</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, dep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dep</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter species with 2 or more entries (plots)</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sp_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># let's plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, color <span class="op">=</span> <span class="va">dbh</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2.2</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">360</span>, <span class="st">"PinkYl"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sp_name</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'id_unique_code'. You can override using</span></span>
<span><span class="co">#&gt; the `.groups` argument.</span></span></code></pre></div>
<p><img src="selecting_plots_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="fia-workflow">FIA workflow<a class="anchor" aria-label="anchor" href="#fia-workflow"></a>
</h2>
<p>For the USA forest inventory (FIA) we are going to explore the Hawaii
inventory plots for 2019. The steps are very similar to the FFI example.
First we need the state code, retrieve the plots metadata and filter for
the desired year, 2019:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download the FIA data if not already (In this example the data is downloaded</span></span>
<span><span class="co"># in a temporal folder and is removed after the R session ends)</span></span>
<span><span class="va">fia_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/download_inventory.html">download_inventory</a></span><span class="op">(</span><span class="st">"FIA"</span>, <span class="va">fia_folder</span>, states <span class="op">=</span> <span class="st">"HI"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Downloading FIA available data</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Unzipping downloaded data in <span style="color: #0000BB;">/tmp/RtmpXWXHqO</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Done!</span></span>
<span></span>
<span><span class="co"># get the plots for those departments</span></span>
<span><span class="va">hawaii_plots_2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/show_plots_from.html">show_plots_from</a></span><span class="op">(</span></span>
<span>  inventory <span class="op">=</span> <span class="st">"FIA"</span>,</span>
<span>  folder <span class="op">=</span> <span class="va">fia_folder</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"HI"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">INVYR</span> <span class="op">==</span> <span class="fl">2019</span><span class="op">)</span></span>
<span><span class="va">hawaii_plots_2019</span></span>
<span><span class="co">#&gt; Simple feature collection with 1177 features and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -160.2893 ymin: 18.87413 xmax: -154.7896 ymax: 22.26451</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,177 × 6</span></span></span>
<span><span class="co">#&gt;    INVYR STATECD COUNTYCD  PLOT STATEAB             geometry</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>125 HI       (-155.875 20.29327)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>127 HI      (-155.8317 20.27703)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>130 HI      (-155.7942 20.26314)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>133 HI      (-155.7351 20.26385)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>137 HI      (-155.9226 20.24566)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>140 HI      (-155.8627 20.23504)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>143 HI      (-155.8276 20.23026)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>146 HI      (-155.7559 20.21695)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>149 HI      (-155.7324 20.21962)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>019      15        1  <span style="text-decoration: underline;">2</span>150 HI      (-155.9376 20.22124)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,167 more rows</span></span></span></code></pre></div>
<p>We can visualize the geographic distribution of the plots:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># USA map for plotting</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hawaii_plots_2019</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">STATEAB</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">160.6</span>, <span class="op">-</span><span class="fl">154.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18.5</span>, <span class="fl">22.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">1</span>, palette <span class="op">=</span> <span class="st">"Zissou 1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="selecting_plots_files/figure-html/fia_states_polygons-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Now that we have the all forest inventory plots selected, we can
create a <em>filter list</em> to retrieve the data only from those we
want, <em>i.e.</em> only the O’ahu island:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oahu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">157.5</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">158.5</span>, ymax <span class="op">=</span> <span class="fl">21</span>, ymin <span class="op">=</span> <span class="fl">22</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fia_filter_list</span> <span class="op">&lt;-</span> <span class="va">hawaii_plots_2019</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">st_filter</a></span><span class="op">(</span><span class="va">oahu</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/create_filter_list.html">create_filter_list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>And now we have everything we need for retrieving the data with
<code><a href="../reference/fia_to_tibble.html">fia_to_tibble()</a></code>. For that we need to provide the state
codes, the year, the filter list we obtained before and the path to the
folder containing the forest inventory files.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We can parallelize the process with the future package.</span></span>
<span><span class="co">## In this case we use 4 parallel processes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="st">"multisession"</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the data</span></span>
<span><span class="va">fia_data_2019</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fia_to_tibble.html">fia_to_tibble</a></span><span class="op">(</span></span>
<span>  states <span class="op">=</span> <span class="st">"HI"</span>,</span>
<span>  years <span class="op">=</span> <span class="fl">2019</span>,</span>
<span>  filter_list <span class="op">=</span> <span class="va">fia_filter_list</span>,</span>
<span>  folder <span class="op">=</span> <span class="va">fia_folder</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Start</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing 1 year</span></span>
<span><span class="co">#&gt; Getting ready to retrieve <span style="font-weight: bold;">109</span> plots for <span style="color: #0000BB;">2019</span></span></span></code></pre></div>
<p>As we did with the French forest inventory, we can now explore the
data, for example, the most abundant species and their mean
diameter:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fia_data_2019</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># clean plots without tree data</span></span>
<span>  <span class="fu"><a href="../reference/clean_empty.html">clean_empty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tree"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># convert inventory table to sf/spatial object</span></span>
<span>  <span class="fu"><a href="../reference/inventory_as_sf.html">inventory_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># unnest the tree data</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="st">"tree"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># calculate dbh by species in each plot</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id_unique_code</span>, <span class="va">sp_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    dbh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dbh</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    state_ab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">state_ab</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter species with 5 or more entries (plots)</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sp_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># let's plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, color <span class="op">=</span> <span class="va">dbh</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2.2</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">360</span>, <span class="st">"PinkYl"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sp_name</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'id_unique_code'. You can override using</span></span>
<span><span class="co">#&gt; the `.groups` argument.</span></span></code></pre></div>
<p><img src="selecting_plots_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="ifn-workflow">IFN workflow<a class="anchor" aria-label="anchor" href="#ifn-workflow"></a>
</h2>
<p>For the Spanish forest inventory (IFN) we will explore the Cantabric
coast forest plots. The IFN, differently from other national
inventories, doe not offer the plot data by years, but by
<em>versions</em>. We have <em>“ifn2”</em> (early 90s), <em>“ifn3”
(early 00s)</em> and <em>“ifn4”</em> (2014-15).<br>
We are going o retrieve the plots for the early 00s version
(<em>“ifn3”</em>):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download the IFN data if not already (In this example the data is downloaded</span></span>
<span><span class="co"># in a temporal folder and is removed after the R session ends)</span></span>
<span><span class="va">ifn_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/download_inventory.html">download_inventory</a></span><span class="op">(</span><span class="st">"IFN"</span>, <span class="va">ifn_folder</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Downloading IFN available data</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Unzipping downloaded data in <span style="color: #0000BB;">/tmp/RtmpXWXHqO</span></span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BB0000;">✖</span> The following files failed to be downloaded:</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ifn4_avila_tcm30-536598.zip</span>, <span style="color: #0000BB;">ifn4_cantabria_tcm30-536602.zip</span>,</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ifn4_leon_tcm30-536581.zip</span>, <span style="color: #0000BB;">ifn4_murcia_tcm30-536584.zip</span>,</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ifn4_navarra_tcm30-536585.zip</span>, <span style="color: #0000BB;">ifn4_paisvasco_tcm30-536587.zip</span>,</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ifn4_palencia_tcm30-536588.zip</span>, <span style="color: #0000BB;">ifn4_segovia_tcm30-536591.zip</span>,</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ifn4_valladolid_tcm30-536593.zip</span>, and <span style="color: #0000BB;">ifn4_zamora_tcm30-536594.zip</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Done!</span></span>
<span></span>
<span><span class="co"># choose the provinces, those in the Cantabric area</span></span>
<span><span class="va">north_spain_provinces</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"33"</span>, <span class="st">"15"</span>, <span class="st">"27"</span>, <span class="st">"39"</span>, <span class="st">"48"</span>, <span class="st">"20"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the plots for those departments</span></span>
<span><span class="va">north_spain_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/show_plots_from.html">show_plots_from</a></span><span class="op">(</span></span>
<span>  <span class="st">"IFN"</span>,</span>
<span>  folder <span class="op">=</span> <span class="va">ifn_folder</span>,</span>
<span>  provinces <span class="op">=</span> <span class="va">north_spain_provinces</span>, versions <span class="op">=</span> <span class="st">"ifn3"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">north_spain_plots</span></span>
<span><span class="co">#&gt; Simple feature collection with 12849 features and 6 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -9.271574 ymin: 42.33748 xmax: -1.743428 ymax: 43.7598</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;      crs   id_unique_code version province_code province_name_original plot</span></span>
<span><span class="co">#&gt; 1  23029 33_0001_xx_NN_xx    ifn3            33               Asturias 0001</span></span>
<span><span class="co">#&gt; 2  23029 33_0002_xx_NN_A1    ifn3            33               Asturias 0002</span></span>
<span><span class="co">#&gt; 3  23029 33_0003_xx_NN_xx    ifn3            33               Asturias 0003</span></span>
<span><span class="co">#&gt; 4  23029 33_0004_xx_NN_xx    ifn3            33               Asturias 0004</span></span>
<span><span class="co">#&gt; 5  23029 33_0005_xx_NN_A1    ifn3            33               Asturias 0005</span></span>
<span><span class="co">#&gt; 6  23029 33_0006_xx_NN_A1    ifn3            33               Asturias 0006</span></span>
<span><span class="co">#&gt; 7  23029 33_0007_xx_NN_A1    ifn3            33               Asturias 0007</span></span>
<span><span class="co">#&gt; 8  23029 33_0008_xx_NN_xx    ifn3            33               Asturias 0008</span></span>
<span><span class="co">#&gt; 9  23029 33_0009_xx_NN_A1    ifn3            33               Asturias 0009</span></span>
<span><span class="co">#&gt; 10 23029 33_0010_xx_NN_A1    ifn3            33               Asturias 0010</span></span>
<span><span class="co">#&gt;                      geometry</span></span>
<span><span class="co">#&gt; 1  POINT (-6.921473 43.55714)</span></span>
<span><span class="co">#&gt; 2  POINT (-6.946525 43.54859)</span></span>
<span><span class="co">#&gt; 3  POINT (-6.897041 43.54769)</span></span>
<span><span class="co">#&gt; 4    POINT (-6.859929 43.547)</span></span>
<span><span class="co">#&gt; 5    POINT (-6.9592 43.53981)</span></span>
<span><span class="co">#&gt; 6  POINT (-6.922401 43.53015)</span></span>
<span><span class="co">#&gt; 7    POINT (-6.860566 43.529)</span></span>
<span><span class="co">#&gt; 8  POINT (-6.947441 43.52159)</span></span>
<span><span class="co">#&gt; 9  POINT (-6.910344 43.52092)</span></span>
<span><span class="co">#&gt; 10 POINT (-6.860884 43.52001)</span></span></code></pre></div>
<p>To visualize the geographic distribution plots we can use:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">north_spain_plots</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">province_name_original</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">9</span>, palette <span class="op">=</span> <span class="st">"Zissou 1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="selecting_plots_files/figure-html/ifn_plots_visualization-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Now that we have the inventory plots selected, we can obtain the
<em>filter list</em> to retrieve the data only from the cantabric
area:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cantabric_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">8.5</span>, ymax <span class="op">=</span> <span class="fl">44</span>, ymin <span class="op">=</span> <span class="fl">43.2</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ifn_filter_list</span> <span class="op">&lt;-</span> <span class="va">north_spain_plots</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">st_filter</a></span><span class="op">(</span><span class="va">cantabric_area</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/create_filter_list.html">create_filter_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## we can do all in one pipe:</span></span>
<span><span class="co"># ifn_filter_list &lt;- show_plots_from(</span></span>
<span><span class="co">#    "IFN", folder = ifn_folder, provinces = north_spain_provinces, versions = "ifn3"</span></span>
<span><span class="co"># ) |&gt;</span></span>
<span><span class="co">#   create_filter_list()</span></span></code></pre></div>
<p>And now we have everything we need for retrieving the data with
<code><a href="../reference/ifn_to_tibble.html">ifn_to_tibble()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We can parallelize the process with the future package.</span></span>
<span><span class="co">## In this case we use 4 parallel processes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="st">"multisession"</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the data</span></span>
<span><span class="va">ifn_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ifn_to_tibble.html">ifn_to_tibble</a></span><span class="op">(</span></span>
<span>  provinces <span class="op">=</span> <span class="va">north_spain_provinces</span>,</span>
<span>  versions <span class="op">=</span> <span class="st">"ifn3"</span>,</span>
<span>  filter_list <span class="op">=</span> <span class="va">ifn_filter_list</span>,</span>
<span>  folder <span class="op">=</span> <span class="va">ifn_folder</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Start</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Processing 1 cicle</span></span>
<span><span class="co">#&gt; Getting ready to retrieve <span style="font-weight: bold;">4834</span> plots for <span style="color: #0000BB;">"ifn3"</span></span></span></code></pre></div>
<p>As we did with the French and USA national forest inventories, we can
now explore the data, for example, the most abundant species and their
mean diameter:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ifn_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># clean plots without tree data</span></span>
<span>  <span class="fu"><a href="../reference/clean_empty.html">clean_empty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tree"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># convert inventory table to sf/spatial object</span></span>
<span>  <span class="fu"><a href="../reference/inventory_as_sf.html">inventory_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># unnest the tree data</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="st">"tree"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># calculate dbh by species in each plot</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id_unique_code</span>, <span class="va">sp_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    dbh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dbh</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    province_name_original <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">province_name_original</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">dbh</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sp_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># filter species with 5 or less entries (plots)</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sp_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">80</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># let's plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, color <span class="op">=</span> <span class="va">dbh</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2.2</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">360</span>, <span class="st">"PinkYl"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sp_name</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'id_unique_code'. You can override using</span></span>
<span><span class="co">#&gt; the `.groups` argument.</span></span></code></pre></div>
<p><img src="selecting_plots_files/figure-html/unnamed-chunk-3-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adriana Tovar, Víctor Granda.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
